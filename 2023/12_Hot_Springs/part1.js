// Day 12: Hot Springs - Part 1
// https://adventofcode.com/2023/day/12
// https://www.reddit.com/r/adventofcode/comments/18ge41g/2023_day_12_solutions/
// https://gist.github.com/Nathan-Fenner/781285b77244f06cf3248a04869e7161

var hotSprings = function (input) {
  const records = getData(input, 1);

  const countWays = memoize((condition, runs) => {
    if (condition.length === 0) {
      if (runs.length === 0) {
        return 1;
      }
      return 0;
    }

    if (runs.length === 0) {
      for (let i = 0; i < condition.length; i++) {
        if (condition[i] === '#') {
          return 0;
        }
      }
      return 1;
    }

    if (condition.length < sum(runs) + runs.length - 1) {
      // The line is not long enough for all runs
      return 0;
    }

    if (condition[0] === '.') {
      return countWays(condition.slice(1), runs);
    }

    if (condition[0] === '#') {
      const [run, ...leftoverRuns] = runs;
      for (let i = 0; i < run; i++) {
        if (condition[i] === '.') {
          return 0;
        }
      }

      if (condition[run] === '#') {
        return 0;
      }

      return countWays(condition.slice(run + 1), leftoverRuns);
    }

    // Otherwise dunno first spot, pick
    return countWays('#' + condition.slice(1), runs) + countWays('.' + condition.slice(1), runs);
  });

  let totalArrangements = 0;
  for (const record of records) {
    totalArrangements += countWays(record.conditions, record.runLengths);
  }
  return totalArrangements;

  function getData(input, expandCount) {
    const lines = input.split('\n');
    const data = lines.map((line) => {
      const [conditions, runStr] = line.split(' ');
      const runs = runStr.split(',').map(Number);
      return {
        conditions: new Array(expandCount).fill(conditions).join('?'),
        runLengths: new Array(expandCount).fill(runs).flat(),
      };
    });
    return data;
  }

  function memoize(func) {
    const stored = new Map();

    return (...args) => {
      const k = JSON.stringify(args);
      if (stored.has(k)) {
        return stored.get(k);
      }
      const result = func(...args);
      stored.set(k, result);
      return result;
    };
  }

  function sum(nums) {
    return nums.reduce((total, num) => total + num, 0);
  }
};

console.time('day-12_part-1');

var input = `???.### 1,1,3
.??..??...?##. 1,1,3
?#?#?#?#?#?#?#? 1,3,1,6
????.#...#... 4,1,1
????.######..#####. 1,6,5
?###???????? 3,2,1`;
var expected = 21;
var result = hotSprings(input);
console.log(result, result === expected);

var input = `..???.??.? 1,1,1
?#?##???.???? 2,5,1,1
?#??????##? 1,1,2
?#.#?#??#??? 1,7,1
?#???#?#??.#.###.? 3,1,3,1,3,1
?#......#.?.?. 1,1,1
.????#????? 2,1,2
#.?...?#????#??? 1,7,1
?.#??.??#? 2,1,1
.#???###?#??#???#?.? 7,1,7
?###?.??#??..? 5,4
.#?.??#????#?.?. 2,4,1,1
#.#??????? 1,1,4
#????##.???#???. 1,1,2,1,5
?.?.##???#???##.? 2,7
????.?#?.? 2,2
??.#?????#??#. 1,10
???????.???#?? 6,1,2
#?.#???.?? 2,4,1
?####????.?.?? 4,3,2
?????#???? 6,1
????.???????#?#.? 1,5
.#???##.?#??#??? 6,5
??#?#?????????????. 8,4,1
???.????#?#.???? 7,4
?#???#?.?????????? 2,1,8,1
#?.#?#?.?? 1,3,2
?.??##??????.?. 1,5,1
????#????????#????.? 5,9
?.#?#????? 1,5
??????#.??.??.? 1,5,1,2
##?#??????#.#?#??? 5,1,2,6
????.?##?#..# 2,3,1,1
??.?..???.?#?#? 2,4
???##???.?#??#?# 1,5,6
??.????#?????#?? 1,9
??##?#????.#???.#??? 1,8,4,1,1
##?#???????. 4,1,3
?#???##?????#? 1,1,6,1
????????##?#?????? 1,14
????#????.??? 1,2,1,1
?##.???.#???.#?.??# 3,1,1,4,2,1
?##???????? 2,2,1
?????#??????.??# 1,5,1,1
#?#?????????#.? 5,1,1,2,1
.?.?.??.#. 1,1,1
.?#.??#?#?????###?. 2,12
??.?????#???.???? 1,1,1,4,2
??????#?##?#?? 2,6
..????#?##???? 1,4,1
.?#?#??.#???. 2,1,1,1
.??????#?? 1,1,1
?#?.?#???#???#? 1,4,1,2
??????????#???##?. 1,1,10
???##????.??? 1,4,1,2
.???#??.##???????##? 5,3,1,6
?#??#???.??? 1,1,1
.??..?????#. 1,4,1
???#?????.. 1,3,1
?#???.?#???#?..#??# 2,1,5,1,2
?#??#?.???.#???. 1,3,1,2
.#??#?.???#???#?? 1,1,9
?.?#?##...??? 1,4,1,1
??#?#?#??##???????. 3,3,3,1,3
???#?#?.??#? 6,3
?#?.#??##.#? 1,1,2,2
?????##??#??? 6,3,1
????##???? 1,2
???.???.???.?. 2,2,3
??#????????????# 5,1,1,3
????#?.?..????.??# 2,1,1,2,1,1
.?##?##???? 3,4
?..??????#? 1,1,5
..?????#.?.##?#.?? 4,4
#???.?????? 2,2
?.??#??????.? 1,4,2
?###??#???.?#?.?? 3,1,1,2,1
?????????.????????# 1,1,1,2,4
??#.??#?##.???.???? 1,1,6,3,1,1
???#.###????. 3,4,1
?#.?????????.?# 1,3,3,1
#.???#.????????#?? 1,1,1,2,7
???#?.?????.#? 1,1,4,1
???#..???.? 3,3
?.????#####??#.?#?? 1,1,9,1,1
????#.?#???? 2,1,5
.#?#..#??????????? 3,1,9
?.??..???? 2,1
???????#??.???????.? 1,1,4,1,1,2
..??.??????? 1,1
??.?????##?? 1,6
????????##??.????? 1,7,1,1,1
???.?###???? 1,5
#.?###??#?#???????? 1,4,1,1,3,1
????.???????????? 2,1,7
#?#??#????.?#????? 7,1,1,1
?##???#.?#???#?##??# 3,1,2,4,1
???#??#?????.?##? 7,3
?????????..??? 1,5,1
.???#???.????#.? 5,1,1,1
?#?????#????? 2,3,1
.???#???#???..??##. 5,1,4
?????.?##.# 5,2,1
??#????#?.# 5,2,1
#?.????#???#????? 2,1,2,1,2
????????.??.?????? 7,5
..#?#??###.??????? 8,3
#?.??.??##?.?#? 1,1,5,3
.#????#?#?##?. 1,8
?#?????#.? 1,3
.???.?..#? 1,1,1
??.??.????? 2,1
?#??????#??##?##... 1,11
.#?????????? 1,1,3,1
??#????#?????#??#?? 8,5
?#??#???..##.?? 7,2,2
?.????.#??#?.?##?? 1,1,1,2,5
.?.????????#??##??? 1,2,5,4
?.???##?.????#???## 5,3,4
#..#?##?#?#?????? 1,8,4
?????##?.?#.?? 1,4,2,1
?????????. 4,1
???#??.???????#?. 5,5,1
?.???.?#????##???# 1,1,8,1,1
???????..????? 1,3,4
?#?##??#?????#?#???? 8,6
???#????#.??????..?. 5,3,6,1
?.??##???.??#? 6,2
??.??.???#????#??? 2,1,8
?????##????.#?. 1,1,7,1
??.??#??.?.##? 5,3
???.?#?#??..?? 1,5,1
.#????##?????? 1,7,1
.??????..#?. 1,1,1
#?#??##.?.??. 7,1
?##?#???..?#.???# 4,1,2,1,1
???????#?? 3,3
?.????.#?#??##.??.? 1,1,4,2,1,1
?.?????##?.? 1,1,5,1
.#???.?.?##.?.? 1,1,2,1,1
#.??.?#?#? 1,1,3
?????.?#??#???# 1,1,8
.??#?##??.??.# 1,6,1,1
#??????#??#???#? 1,6,1,2
.??..?#????#???#??? 2,3,7
.??#.??##.?#?.#?#? 1,1,4,1,3
???.??#???.???. 2,1,1,2
?#?..???#??.? 1,2,3
?#??#.#????????.?.?? 1,1,6,1,1,2
#??##?#????.?#???## 1,4,1,1,1,2
.???#?????? 1,2,1
??.?.?##..??#?. 1,2,3
?.#?.#?#??#??#?? 2,3,6
?#??.#??.???????? 1,1,2,6
?#??.#???#???#.??.?? 4,1,6,1,1
##????#?.??????# 4,1,2,1
..?##????.. 3,3
.??#?.???? 3,1
??..????#?.?? 1,2,2,2
?.????.???.#..#? 2,1,1,1,2
??#?##?#??##. 6,3
????????.?????.?.# 1,1,3,1,1,1
.?#?###?#?????.???? 8,2,3
.???##??#?.?? 5,3,1
.?#??##??#.?# 9,1
?##???.??????? 3,1,1,2
?#?#?#?????????????? 6,1,1,1,1,1
.??#??##???#????. 11,1
?#.#????##?? 2,1,1,4
?.?.?.??#?????.??# 1,1,8,1,1
?.??.?????.? 1,1,4,1
?.#???.##.????.??? 1,2,1,2,3,2
.?.#??#??? 1,1,1
?.???????## 6,2
?.?.#?.##???.?. 1,2,2,1,1
???..?.??#???#????# 2,1,1,1,3,2
?????????.??#? 2,1,2
.?.?#.#??#?????#??? 1,1,4,1,1,1
????#??.?#????#??? 4,4,2
.????.?..?.??.?#.?. 1,2
??#?????#?#??.??#??? 1,1,8,4,1
?????????? 1,4
?.?#??.?#?????#? 2,3,4
???.##.??.??? 1,2,1,1
.?.???????#.#.. 8,1
#??.????###??????? 1,1,3,8
??#?#.#??..?? 3,2
#..??.????#???.#?#?. 1,1,5,1,1,1
??.??.???#??.? 2,1,6,1
.????##???? 1,7
.?###?.??.? 4,1,1
?.?#??#?.#..??#??? 6,1,1,1,1
.??????.?# 4,1
##????.?????.?? 6,2,1,1
.?????#.?? 1,3,1
?.????#??#?????? 6,3,1
.????#?.#?.?????#?# 6,2,6,1
.?.???#????###???##? 4,10
?..?#????? 4,1
.??#??.?##.?.#?#?#? 3,3,1,1,1,2
..??#.??????.? 3,1
??????????#?????.. 1,6,1
??#????#?????###?? 7,6
???..#???? 1,1,1
..#?#??...???#?.? 1,1,1,4,1
..#..????#???####. 1,10
?#??????.??? 1,2,1,1
??????.#???. 5,4
??#?#.????? 4,1,2
?#??.??.??#.? 1,1,2,2
#???.??#??#?.?#??##? 1,1,1,5,7
???.??#?.?#?? 1,4,1
.??????#???#????#?. 3,5,6
???????#?? 2,2
#??#?#?###?..??#???? 1,4,4,1,3
?##??????#?##???? 4,2,7
???????..?.#???? 5,1,1,4
?????????#???#??? 1,1,1,7,2
?.##.???????#???. 2,6,1,1
.?##?#?.?#?..?. 5,3
.????.?.?. 2,1
??#??#?.????.??..? 5,2,2,1
????##?#???. 1,3,1,1
#?.??##?###.??#? 1,1,6,1,2
?.?.?#?.#?.? 1,3,1,1
?????????##???##???. 2,2,3,6
#????????.???##.? 4,4,5
???????..???? 5,1,3
??.????##????###??? 2,1,5,5,1
??...??#????#???. 2,8,1
???#??????? 1,3,2
????.??..?.?? 2,1
.???.#?????. 1,6
??#?????#.??.#?? 3,1,1,1,1
##?.???##????????? 2,4,1,2,1
???###??##?.?.?.???? 9,2
???#????.? 1,6
??#???#?..#.#?? 5,2,1,3
.??#????????#? 8,1
?.?#??#????#??? 1,5,1,2
???..?.????#???#.? 1,1,1,3,1,1
????##???.#?#?. 4,4
??#?.#???? 3,2
?.#??#???#????? 1,6,1,1,1
??????#?#??#?.???? 1,1,7,1,1
?.?????.?. 2,1,1
.??##?.?#???? 2,2
.#??#??#?????.??#.? 1,5,2,2
?.??#?.???# 3,1,2
?..???????? 1,5
#?????????#?#??.?#. 2,1,2,7,2
?.?????##.?#??# 1,2,2,2,1
?????.??##. 2,4
??##??#??.?#?????. 1,6,6
???###???? 5,1
###???#???.????????. 4,1,1,1,2,1
??.???#.?#?. 2,3,1
?#?.??#?.?#????#?? 1,2,1,3
?????????#?? 1,7
??????????????????.? 1,5,4,4,1
?#.?.???#?? 1,5
?###?????#??? 5,2,3
?.???#???#??????. 1,1,4,2,1
?????#??####.##??#? 6,4,2,3
???.#???.???#???? 4,4
??#?.#?###????? 1,6,2
??????#?#?#???.????? 2,8,3,1
.?????.???????????? 1,4,3
?????.?##???? 4,3
???#???.??#??? 4,1,4
#?????.?.#. 3,1,1
.?##???##?#??????. 2,1,4,1,1,1
??????#?.????. 6,3
?.???#?#?#??.#??# 2,1,5,1,1
???##?##?.?.??#.? 8,3
???#???????..?? 1,1,1,2,1
??#???#.??#??..??? 7,1,3,1
????#?.?.#.?? 5,1,1,1
#??##.?#????#???? 1,2,1,5,1
???#.????..?##?? 4,1,2,1
???#?????.??.????# 5,1,1,1,2
????.?.??#?????#? 1,1,1,1,8
???#???#??## 2,5,2
#.????#?.?#????????? 1,5,1,1,1,1
##?#?#?.?? 6,1
.#?#??????#????.?? 1,2,3,2,1
?#?????.#?? 7,2
???#????.?. 1,4
?.#.?.???.##.## 1,1,2,2,2
???????.?.??#??#.? 2,4
????.???.#?? 2,2,1,1
.??#?#?????#?#??#? 5,3,4,2
##?????????.?????? 6,2,2,2
???#???????? 1,1,2,1
???????????..??#? 2,1,1,1,3
?????.??.???? 5,1,3
?????????..?# 1,2,2,1
??????????.?#..?? 3,4,2
???#?#?????#..????? 9,3
??????.?#??#???#? 1,4,1,6
??#?#????.??? 5,1
???#.?#?????##. 3,9
?????#???.????#? 2,1,4,1,3
.??#???..???? 6,3
?#.?#..??. 1,2,2
.????????.? 1,2,1
??.?#??.???? 1,2,1,1
.?..#?.??.?.??? 1,1,2,1,1
???#?#????###???? 2,1,3,4,2
????..??## 1,2,4
????????..???#????#? 1,3,1,9
??#????.##?..??? 5,2,2
???????##.???#?. 3,5,3
?#???.???????? 4,8
???????#???..#?.? 4,5,2,1
???.??##????.#??.? 1,8,1,1,1
??.?###???.??#.?? 1,6,1,1,1
???.##??#?#? 3,7
.??.???????????? 1,6,5
?#?#?.??.??.??? 5,1,1,1
?????#????#???#??#. 5,2,5
??#?#?.??#??#??????# 4,13
#??#????.???## 8,1,2
????.????. 2,2
#??#???#?????#? 4,3,3
#?????#.#?.? 2,2,1
#???.??.#.#? 3,1,1,1
???????#?.?#??## 2,2,5
???##?.#???????#. 2,3,4,3
?#??.???.#. 3,2,1
#?##?.?????.#?#?# 5,2,1,5
???#????#.?????? 4,1,1,2,1
#.?.?##?#?#???#? 1,11
?.??.?#??##?? 1,7
?????#..#?.##?#????? 1,2,1,4,3
#????.?##????##??# 1,1,4,5
?#????.???##? 3,5
?#?.??????? 3,1,1
.#.???#...#??. 1,3,3
?#?...???#? 2,1,1
??.#??.???..? 1,3,1,1
.?????.#?? 5,1
#?????#.##?#?????? 2,4,7,1
?.????.??#??#??#??.. 3,1,1,6
??????????? 2,7
?.????..?#?# 2,4
?????#..?#????# 1,1,1,3,2
??.#????###???????#? 9,4
?#??.##?.??.??????? 2,3,1,2,2
.#?##.?#??# 1,2,5
??###?#?#??????.?#? 1,8,2,1,2
?#.###???#??????? 2,11,1
?.?.????#??#?# 1,1,1,3
?????.??#???#? 3,2,2
?#..???.??##???#?? 2,2,3,1,1
??#?#..?#???? 3,1
?????????.? 2,1,1
??#?#?.?#?. 5,2
#????#?????#.??. 8,1,1,1
#???#?#???.##..?#. 8,2,1
.#.?#?##??.?..??.?#? 1,5,1,1,1,3
???#????.???.# 5,1,1,1
?#??..???#. 3,3
????#?????#..??#? 1,2,5,1,1
..???????##???? 3,5,1
??#?##.???#??? 5,3
??#?????????##?##?? 5,5,2
.#???????? 7,1
?.?.#.?#???????? 1,1,1,5,1
??##...??#?. 3,3
.??????#??? 2,1,1
#??.??????.? 3,1,1
..?..?..?????#? 1,3
??#.???????#??? 2,1,6,1
???#??.??. 3,1
.##???...#????##? 5,7
??###????.?????? 8,4
??##??..??.?# 6,1,2
?????#.??# 1,1,1
??#?????.?#??????? 4,1,1,4,2
??##??..??? 6,2
##?##??#?????#??#.# 11,1,2,1
.?##?#.?#. 5,1
?????#??????##? 1,11
????#????????####? 2,1,6
.?.?#???????? 6,1
???#?#????.??#?? 5,1
#??#.???##?????#? 1,1,6,1,3
.??.?#???????# 1,4,1,2
??????#???..??#?#?? 4,5
?????.?..????##?#. 2,8
?????.#.?#?? 4,1,3
?????#???.??.??# 1,1,2,1,3
?#??????.??#???#??? 1,1,2,4,4
.???#?#???. 1,1,3
????.??###??? 1,1,3,1
.?#????#?##?#.? 2,5,1
..?.????.?.??#??? 1,3
???##?????.. 3,1
##???????????#?? 8,2,1,1
????###?????##?..? 1,1,6,4,1
.?????????#??#??#?? 10,2,2
?#.??????? 1,1,1
#.????????## 1,1,1,2
??#?.??????#.?.???? 3,2,1,1,1,1
?#?.#??#??????.????? 2,7,1,4
?##??#????##?#?.##?? 2,3,3,2,4
#..#?.??#??#?? 1,1,6,1
#.???..???????? 1,1,1,4,3
?##????.?? 2,1,1
.?#??..##????..?? 2,6,2
..#?.##???. 2,4
#?.???#.?? 1,2,2
???##??????.??. 1,5,1,1
?#???#??#.????? 9,1
????#.???? 5,1,1
#??????.#???#???# 1,2,1,7,1
#?????##??#????.???? 3,8,1,1
?.#????##?#??.?..?? 1,2,8,1,2
#???????.??#? 1,2,4
??###??.?.? 6,1
.??????#.??? 1,1,1,3
.??#??###???#?..?#.. 9,1,1
?.?.??##?# 1,6
????#?????# 1,2,3
??##??????##??# 11,2
?#?????#?? 1,2,1
#.#??.???#.##????#? 1,2,2,1,8
?#.??#?????? 1,3,1,1
..???????.? 3,2
#??.?.???????? 3,1,1,1
??##???#???# 8,1
#????.?#??#????#.. 1,1,1,1,3,1
?####?#???.?.? 8,1
..#.???#??.. 1,4
.??.?#??????#???? 1,9,2
?#?.?????? 3,4
#??.#?????????? 2,2,3,3
??#????.???. 5,1,1,1
.??#???#.??#?. 3,1,3
.?#??#.#?.?#?.# 2,1,1,2,1
??????????.?????. 8,2
?.???.??.?? 1,1
#?.?????##..###? 1,1,4,4
?.#??.????.##? 2,3,2
????#????? 1,2,2
?###?.#???? 4,2
.?.?.????.?.#?? 1,1,1,1,3
.??#???.???#??##???. 4,5
..??#??#..##?#. 4,2,1
?##???##??.??????.?? 8,2,2
#??#?????#?#. 1,5,1,1
???.?????#??. 1,1,4
..???##??#??.?? 7,1
??.#.?????.??????#? 1,1,1,2,1,2
?#.#?.#????##??##? 2,1,1,1,2,2
?##?.?..##???? 3,1,4
????..?#??#.? 3,5
.#?##???.?#.. 6,1
?.?.???..#????? 1,1,1,2,1
?.#???#????#?#?### 1,12
??.?#?#..?#??.???? 3,3,1
???#?##?## 1,7
#???????.#.#..#? 6,1,1,1
????????.????#?? 2,2,1,1,3
?????.?#?#?#?????## 2,2,5,1,3
??????#.???? 1,4,1,1
?????#??.##?. 1,2,3
?????#???.???.? 1,6,1
?#??.??#????#??##? 3,11
??#?.#??#???? 2,4
..??#????.??? 2,1,1,1
??????#?#??..? 2,3,1
?#?#??.??###????? 4,5,1
???#??##?#??.?.??#? 1,1,6,1,1,1
##?.#.?.#??#.#? 3,1,1,2,1
?##??.?.?????#? 3,2,3
?##?#???##???#.#?#? 12,1,1,1
???#?#?.?#???. 4,3
.????##??. 2,2
??#???#??#?????????. 1,8,3,1,2
?#????#... 2,3
??.??#???? 1,3,1
?#?.????????#? 1,3,1,1
?..??#?.#.????? 4,1,1,2
?????.????#?????.?. 5,7,1,1
??.?#?.?##???#??#? 2,2,8,1
?????.#??#??#?????? 1,1,2,1,7
??.?????.#? 1,4,1
?#?#???..##?? 5,3
?.?.??????. 1,2,1
?#?#.?#?#???????.# 2,1,7,1,1
??????????????#???? 2,1,1,9
#?.???.??. 1,1,1
#?.?????#??.##?#? 1,1,4,5
?.????#??.? 3,1
???#??##????##??.?. 1,1,11,1
??#????????#? 1,4,1,1
???#...?.? 2,1
?#????##??#????. 1,1,2,5
?.?.#???????.#?.??. 4,2
.???.#?#?????#???#? 1,1,8,3
?.??.?.?.??# 1,1,1,3
#?..#?.?#? 2,1,1
?.????.#??#? 1,1,1,2
?#???????? 2,2,1
.?????.???.??????.. 3,1,1
.?#?.##?##. 1,5
??#????...?##. 6,2
??..#??#??????????. 1,14
#?.#?????##.#???.#.? 1,8,1,1,1,1
#????##???.????.?? 1,1,6,1,1,1
????#.???? 5,1
?##?#???####?#?? 4,1,7
?.?????.?#??.#? 1,4,2,1
??#?.?????. 2,1,1
???.?#???? 1,3
##?????#?#?.#??#?# 2,1,4,1,1,1
?#????.#??##.#?? 3,1,5,1
.?#.?#.#?.?? 2,1,2,2
??.????.#? 1,2,1
??..????#.?? 2,1,1
??.?.?#?#.???? 1,1,3,2
?#??.????#? 3,6
?????#????###?? 3,4
?##??.#????????#??? 4,1,4,1,2,1
??##?#??????????. 1,11,2
#?.??????#??#?#??##? 1,15
#?..???##?.#? 1,1,2,1
?.?????#??#???.? 1,6,1
?##??????#?.? 6,2
..?###??..?.????. 5,4
???#??..?.#. 3,1,1
??#??#???###.?#?? 12,2
?.?#..?#.? 1,2
##??#?????? 2,1,1
#?#?.#??#?.?# 4,4,1
???#??#.?? 1,2,1
?#?.??.???# 2,1,2
?#??#??#???.?.?#??? 10,2
?????.##?#???? 1,2,5,2
?.?.?#??????##. 1,3,4
.#??..????#..#.??? 1,2,2,1,1,1
.?..?#?..????? 3,1
??????????.??. 7,2
??.?#?###.??? 1,5,1
.???#??.??#??. 2,1,5
?#???????.??#? 2,2,4
#?#????.???#?? 5,2
?#??#???????#?.#?? 1,1,4,1,1,1
#?#??##..?#????#??. 7,1,3
?##???.#?. 2,2,1
.??.????#??#???? 1,7,1
?#?.??##?..??? 2,4,2
..?#??.??. 2,1
??????????????.???. 4,2
#.?#?#????#???#?.?? 1,1,11,1
??#??.#?..#?#. 1,2,1,3
.??????#?#?#??. 2,1,1,1,1
?.???.???##???? 2,1,4
??.??????.. 3,1
.?#?????#?#??..? 1,6
.?#?????????? 3,3
.??..#??.???? 1,3,2
??#?###??#??. 2,8
?.??##???#??#?.?? 1,5,6,1
????????#?? 2,1,4
??###?????? 4,2
?.###?????#???#. 3,2,1,3
#????#????? 1,4,2
????...??????#???.?? 1,2,1,1,6,1
??????#??#?.?.???# 1,1,7,1,3
??#.??#??? 2,5
.?##???#????##???#? 4,2,2,2
?#??#.??.???#?????#? 4,1,1,2,1,2
??.??????????.? 1,1,1,2,1
??.????#.????#? 1,1,6
??#??#?????? 7,2
???.??????#??????? 3,2,4
#?#?#?#?????.???? 1,1,8,1,1
???????#?????##????. 1,9
??.??.???##??.????.# 2,2,5,2,1
???#....#? 2,1
??##?.??????#.. 1,2,1,1,1
#?????##?#????#?. 5,5,1
???.#.????.???????? 2,1,1,1,3,1
#????.#????.????. 1,1,4,4
?????###???#??.#? 3,4,2,1
??.??#??????? 2,1,1
???..#???# 1,1,1
???????????????? 2,1,1,2,1
???##?????? 2,1
??????##????#???? 7,1,1,1
#?#?..???#?##? 4,5
#.????#?.????#.?? 1,2,1,5
.???.?????...?#?.?? 1,2
?#?.?#????????.???## 2,4,3,5
.??#.#????#?#????#?? 3,2,9,1
??####.???#?##?? 5,1,2,4
??????????#?#?#?? 1,1,1,2,3
?#?#?????###???##.. 4,2,8
???#??.?????#?? 1,2,1,4
?.???##???. 1,3,1
?#?#????#???#? 1,6,4
?.?#?.?????#??? 3,4
???##??#?## 1,2,4
?#?????????.?? 5,1
.??##????#?#?????? 2,6,1,1
?#??#??##. 1,5
?.????.??#?. 1,1,1,1
???#???.??#???#??#? 4,10
#???#?#.????????#? 7,1,1,1
#????#?#?? 4,3
???.??.?????? 1,2,3
??.#.??????##??? 1,1,1,1,6
??????.???? 4,1
?.?#??.#??. 3,1
?.##???#????#??????? 3,1,1,3,2
.?????#????.??#?.?. 3,1,3,1,1,1
?#??#??????#? 1,3,5
???#?.?.?. 5,1,1
##..??#??##?? 2,8
?????#????# 2,3
?#.???###?????.. 1,7
?###???#??##??# 8,5
??.?.?#????? 1,1,2,2
?#?.??.?#? 3,1
????????.????#?#.?# 1,2,1,6,1
??##...????.????#?. 3,1,5
????..???.?..? 3,1,1
.#???.###?#?? 2,3,2
?##?#??????.?...# 4,2,1,1,1
???#?????#.? 1,4
??.??#??..????. 1,3,1,4
.##?..??.?#?? 2,1,3
???##.?.?.?????#?? 1,2,1,3,2
??#??#?.?????????. 5,2,5
#??????#.??#?? 1,2,1,3
.??#???????? 7,2
.#?#?.??#.? 3,2
????##?##??..???. 9,2
.????.???#? 3,4
?.??#??###?#?#?. 9,2
???#???.?? 2,1
.?.??????? 1,2,2
??????????.#? 1,5,1
?????#?.???#??.??? 1,4
??#??.##.?? 3,2,1
???#???#??#?#????? 3,2,5,1,1
?#???????.. 4,2
.?????#????.?#?? 5,3
?..????##????????? 6,4
?????#?.?.??.#?? 3,3
???#???.#?#?.?#??? 1,2,1,1,2,3
#????.??#??. 4,1,3
???#??????#???##? 4,9
??.?..#?.????.. 2,1
#??#.??.#????#? 1,1,2,7
???.?#.?..?.?? 2,2,1,2
?.?#?##??.#.#?.?#. 1,5,1,1,1,2
?#?#??##???#???? 11,1
.????..#???##? 2,1,1,2
#??.??##?.?.??#??#? 3,4,1,3,3
##??.?#?.###? 2,2,3
?#???????????### 1,1,1,1,3
.?#?##???##??????? 4,4,1
?.????????#????? 2,2,6
?#??.?..######?# 2,1,8
???.??.???##..???#? 1,2,1,2,1,2
...##??.#?.?? 4,1,1
?.#?..??.? 2,2
?##??..?##???? 4,2,3
???#?#??????.?#??? 8,4
?#.?????##.??#? 1,2,4,2
???#.#???##?.# 3,2,2,1
?????????????..?.? 1,6
#???????.?# 4,2,1
???????#??? 2,1,3
.???.######?.? 1,6
??.??????. 2,1,1
?#????.????#?#.?.??# 3,7,3
??#??.????? 3,2
???#?????????????#?? 10,6
.?.????.???. 1,2,1,1
??.????#.?#?? 1,2,1,2
.?.???..?# 1,1,1
?#?...?##??? 2,2
##??##??#?.?.??. 10,1
??#??????????.?.??? 12,1,1
?????#?#???#????.?# 1,11,1
?.???.?.??? 2,3
??..?#?#??#???#?? 1,2,9
.#???..??## 3,1,2
?##?#??.?.????????. 6,1,1,1,1
??????#?????#??.?? 1,13,1
#?..????.#???#?? 2,1,6
.???#??..#? 4,2
????..?#?? 1,2
.??#????????.#.?? 8,1,1,1
#??.??.?#. 2,1,2
??#.?.??????##?? 1,1,4,3,1
??.??.?#?.?????#?? 2,1,1,2,3
?#????????#?.?#. 10,1
??.????????? 1,5,2
?????.?.???#???.?.?? 2,6
.?####?#?#???#??? 8,3,1
?????##.?#????.??.? 1,4,2,2,1,1
.?????????#??????#? 3,10
.??.????## 1,2,2
?.##.?.??##?.? 2,5
?????#???? 7,1
.?#...?.#. 1,1,1
.???##.???#.?.##?. 5,1,3
?.?????..?..# 1,2,1,1
??#??????#?? 4,4
?????#??.?. 4,1
???#?.?#?#??.? 2,1,5,1
??????.????. 1,1,1,2
.?.???#.#?????#?? 1,3,1,2,3
????#??????#??.??#? 12,1
??...?..??????#.?? 1,1,6,1
.?.??.???.?#?? 1,2,3
?.????#?????#?##??? 1,13
?.???#?##???.#..??? 1,1,1,4,1,1
?.#?##???#??#.?? 1,9,1,1
??#?.?#??#.? 1,5
??.#?????..????#???? 1,1,3,8
???#?#?#???#?.??# 1,10,2
.????##??? 1,5
???#??..?.? 6,1,1
?.?.????????#???? 1,1,3,1,5
????????#?..?????? 5,2,6
?????????#????#.?# 2,5,1,2
.???????#??#?? 2,6
#??..?##.?? 3,2
?????????#?#??#?#. 2,5,4
?#??.?.?#??? 4,1
###?????##.?.#?#... 10,3
???#?##?.???#?#????? 2,5,2,1,3
??#?.??.??#.##???#.. 4,1,1,1,4,1
??#???.??????.? 3,1,2,1,1
??#???#.??##????? 1,2,2,7
.?#??.????##??#?.?? 3,7
?.???.???? 1,1,3
?????.???????????### 1,1,1,1,1,5
?.?.?????#?..??#?#? 1,1,1,1,1,6
?.#.?.?????#?#?#?#?# 1,14
?..##???#??#??#????? 1,4,12
??????#?#?. 6,1
#??..??###??.??#???. 3,5,4
??##.?##.??????.? 3,2,1,1
??#????.??.????? 1,2,1,1,2
#?#????????.??????? 5,2,5
???????.????? 2,1,1,1
????.????###???? 2,6
#??##?##????.. 9,1
#??#.##??? 1,1,3
###?.?##?.? 3,4,1
??#???##?#?????# 2,11
.?#.??.??.? 1,2,1
??????#????.? 2,6
???##?#???.?#??#? 4,1,4
....???#?..##?..??? 5,2,2
?..?..?????.##?###?? 1,1,4,6,1
#??????????? 2,1,1,4
??#?????.?????#??.? 5,2,4
.?????.????? 1,1,3
?#?.?????#????#?#??? 3,2,1,5
.?#??????.? 3,1
#???.??.??.# 4,1,1,1
?.#?.????????.??? 1,2,2,1,2
??.?#?##??????.. 5,1
??####????.?#?.?? 7,2
.?###??????????## 5,2,1,2
#??.?????.???#? 2,2,1,2
????????#??.??#? 1,1,3,3
.?????????????# 3,7
###?#?.??? 3,2,1
?#?##??..#?#?? 5,1,1
.#?.?#...??# 2,2,3
.#???#?????#??. 1,1,6
??##????????? 5,4
.??##??.????.?? 5,1
???#?#.#??###?#?.# 1,1,1,1,5,1
?????#????? 3,1
.?????.?#.? 1,1,2
??????..?.?? 1,2,1,1
????#.???????????.? 1,7
??#??????##??#. 3,2,5
???????.???#??.???. 5,1,1,1,1,2
?#?????#?##.???#??.? 1,5,2,1,4,1
.???#..???????? 4,1,3
?????.???. 2,1,1
??#??.##??.? 2,2,1,1
.??#???????...??#??? 10,1,1,1
.##??#???????..????. 5,2,1
.?#?.?.???#? 2,3
???????.???#?? 1,2,5
???.??????.????#??? 3,3
??????????????#.? 1,1,1,5,1
???????.#?? 4,2
#?????#????????.? 1,1,8,1
###??#????? 6,1
???????????#?..???# 3,5,3
??#####??????.?? 6,3,1
?.????.??.?? 3,1
.##??#????#..??... 2,7,1
??#?#?????.#. 4,1,1
#?????##?#??..???? 2,1,6,1,2
??###????????? 7,1
???.??.#?#.?????? 3,2,3,2,2
?#?????#?????? 2,8
???????#?#? 1,2,3
?#?#??.?#.??##???? 4,1,1,1,5
??????#??# 1,5
?#?..??#??. 1,4
???????????. 4,1
.?##?#????????#??.. 4,8
???.????...????.. 2,2
??????.#..??? 1,2,1,1
?????????? 1,3
???#?.??????.? 4,1,1,1
?.???????#. 1,1,2
??.??????.????#?? 2,1,1,2,5
.???#??????.#??. 9,2
?#?#?.??.????. 2,2,2
.?.?????.? 1,2
#????#?#???.???.? 1,3,1,3
..#?##???????#??.??# 6,1,3,1,1,1
?.?..#?????.???????. 2,5
?.?.???.???? 1,2
?.#???.?..?.#?? 1,3,1,1,2
?.??#???.????? 1,4,1,2
#??.??.??# 3,2,1
????#???????#? 5,3
?#?.?#??.?????? 2,3,4
##???.??????? 5,1,1,1
??..?##?????????. 5,1
.??????.#??#.##...# 4,1,4,2,1
?.???#???.???. 1,4,2
##?#???????.?????##? 6,3,1,4
???.??.#?#? 2,1,3
???.?.##..?????? 2,1,2,4
#????#??##??.?#? 2,1,4,2
#????#?????.???.. 1,1,2,2,2
???#?.??.????? 1,3,5
?????##??????????# 1,6,1,1,1
?#?#???.#???????.. 4,8
???#??#???..?#?. 2,5,3
?.???#.?.??????? 2,2
.?#?#???#???#?#?? 4,9
.?#?..#?##????.???.. 2,4,1,1,1,1
???#..?.?? 4,1
.#??.?#???#??.???? 1,8,2
.?????#??##?#???? 2,2,2,1,1
???.?#?.?. 2,2
?##??#??.??.##??#??. 6,7
.#.??????#?????#?# 1,1,3,3,5
.?.?????????????##? 1,3,1,7
??.??????#?##??? 1,1,3,3,1
?????.##?#? 1,1,5
.##.??#?.??.?? 2,2,1,1
??#..#??#?..#??? 3,5,1,1
??#????????#?????? 13,2
?#????..?.??? 2,1,1
?????#?.#????. 4,2
.?##?.?..? 4,1
?##?#??#?##??#?? 12,2
#?##?.???????#?#?#? 1,2,1,8,2
?.?.##?.????#??# 1,2,1,1,4
????.???#?.? 1,1,2
..????##???????#???? 7,5
??????#??????? 1,8,2
?#?????????. 1,1,5
??#?##???????????.? 8,1,3
#.??##???###??. 1,10,1
.????#??#?#???.???# 12,4
??.?#????#?.???.. 1,7,1,1
???#####?????.##?? 7,1,3
?.?????.#?#?.?. 1,5,3,1
..??..##?????. 2,2,2
??????????#? 1,1,1,1
#?#??.??##??#..? 4,2,1
#?.????.???.? 1,4,3,1
?????#????##?#?### 1,1,1,1,8
?.??##??.?#.? 6,1
#???????.????? 4,1,3,1
#???#???#??..?#..??? 3,1,1,3,2,1
#??.???????#????? 3,9
??#?##????#??????.? 5,8
#???????#???.?#???#? 1,1,5,2,3
.#???#????###.??. 1,8,1
?#???#?##?##???##?#? 2,12,1
#.?.#???#.? 1,1,2
?.??#?#.???#?????.?? 3,3
???#.??.??#??#??? 1,5
?????#???? 2,3,1
????.?#??#?????????. 2,1,5,2,4
.?????.#???##?#.?.? 2,1,6,1,1,1
?..#?.??...?#? 1,1,1
?#.??????? 1,1,1
??###..?#? 4,2
????##.?#.#???????? 1,2,1,5,2
#??.?###?##???.?? 1,1,6,1,1
???#?????...???.??? 4,2
?.?.??.??#????.? 1,1,5,1
??#?.?????.?????? 2,1,1,1,4
?.?.???.?#?#???? 1,1,2,3,1
??##?..??#??.?.. 2,1,1
.??.??.???? 1,2,2
?#.??##????#.???? 1,3,3,2
??#?#??????#?# 5,7
??#.??#.#?#???. 2,1,1,6
??#????.??. 5,1
????#??.???##?#?#? 6,8
#???#??#?? 2,1,1
??.???#???#? 1,5
.#...??.????.?# 1,2,1,1,1
##.????#?.#..?#? 2,4,1,2
????#???#?.?.?#??? 9,1
?#.???#??#??????#? 1,4,1,1,1,1
??????.??.?????#..? 2,4
??.?###?.???#??##??? 4,5
?#..##???#?#?? 2,10
..??????#?.?##?. 1,4,3
?????????? 2,5
????.?????????#?##?. 1,1,2,2,2,5
.?????#?.#?????? 1,3,4,2
??.????#?. 1,4
?#?#..#.#??##????? 3,1,6,1
?..?.??.??????? 1,2,6
.#??#?#?????## 2,3,6
?#?..???...???##.? 1,3,5,1
?###??????##?#?..??? 3,3,6,2
?????#.?#???. 1,2,1,4
???????.??#???? 1,1,1,5
.???.??..?#???.?? 2,3
#.??.#?????..???# 1,1,3,1,4
?.??.?????????. 1,1,2,6
?#.#???..?.?#?? 2,1,1,1,2
????????#??.??#????? 1,1,4,1,6
.#????#?#.? 3,1,1
?#??#.????.#?.. 1,1,2,1,1
?????##??.?????? 2,6,1,2
#.??.???.???????. 1,2,1,1,4
??##?#?#??..??? 7,3
?#???.??.?. 4,2,1
?????#?????.# 5,1,1
?#?.??#?.?#? 1,3,3
?.??.???#?#???. 1,5
??##.?#???.???.#. 3,4,2,1
.???..??.??. 3,1,1
#?..?.??#?.? 2,3,1
##???#.?#?.#?? 6,1,2
?#.??.?#.? 2,1,1
???????????? 1,1,1,1
?..#???#??#?#?.?# 1,2,3,4,1
?##?#??????????##. 11,3
#?#??..?.#?????#???# 1,1,1,1,11
??.?##?#??.??#???? 1,6,5,1
??.?#?#..?.?. 4,1
##?..????.?#.?#? 3,1,2,2,2
???#.???#? 1,1,2
??#?????#?#?#???#? 13,1
??#?...??.#?.?#?? 1,2,1,2
?.??.????#.????.??. 1,1,1,1,4,1
??.?????.#? 1,5,1
??.#?????#.. 1,4,1
?..#??????.?? 2,1
??#???#?.#?? 6,2
???????#?.#?? 3,1,2,3
?#?#??##.?#???#??? 8,1,5
??##?????.????? 5,1,1,1
???..??.?##. 1,1,1,3
?.?#?..#.?#? 3,1,3
.???????#??#? 7,1
.#.????#?#?#?. 1,3,3,2
??#.#..????????#??#. 3,1,8,1
#??????#.??? 1,1,1,1
?#?????#???? 2,1,1,1
#?????#??#??#.?#??? 1,7,1,1,1
???#.???.???.?? 3,2,1,2
??#?.???#####?##?? 1,1,1,10
??#?????.#??? 6,1,2
????#????#?.?? 2,4,2
????????#? 1,1,5
???#???.?#.?? 4,2,1
?#??..???#?#??????#? 4,1,5,4
?#?.?#?#???##?#? 1,4,4,1
???#.?.#?????# 3,1,1,1
???.?#?.????? 2,1,5
.?????#?#??##.?????? 9,3
??#???#.???? 7,1
????#?####.?#? 6,2
?.?????????#??.# 1,1,2,6,1
?????.?.???#???? 4,1,4,2
#?.?.??#?#??? 1,1,3,1
??#?.?????#??? 4,1,5
?.?????.##..??? 1,2,1
???###?#??.???.? 7,1`;
var expected = 8419;
var result = hotSprings(input);
console.log(result, result === expected);

console.timeEnd('day-12_part-1');
